{"version":3,"file":"index.modern.js","sources":["../src/utils/polyfill.js","../src/utils/index.ts","../src/observer/dep.ts","../src/observer/utils.ts","../src/observer/array.ts","../src/observer/index.ts","../src/observer/watcher.ts","../src/lib/lucky.ts","../src/utils/math.ts","../src/utils/tween.ts","../src/lib/wheel.ts","../src/index.tsx"],"sourcesContent":["if (!Array.prototype.includes) {\n  Object.defineProperty(Array.prototype, 'includes', {\n    value: function (valueToFind, fromIndex) {\n\n      if (this == null) {\n        throw new TypeError('\"this\" is null or not defined');\n      }\n\n      // 1. Let O be ? ToObject(this value).\n      var o = Object(this);\n\n      // 2. Let len be ? ToLength(? Get(O, \"length\")).\n      var len = o.length >>> 0;\n\n      // 3. If len is 0, return false.\n      if (len === 0) {\n        return false;\n      }\n\n      // 4. Let n be ? ToInteger(fromIndex).\n      //    (If fromIndex is undefined, this step produces the value 0.)\n      var n = fromIndex | 0;\n\n      // 5. If n ≥ 0, then\n      //  a. Let k be n.\n      // 6. Else n < 0,\n      //  a. Let k be len + n.\n      //  b. If k < 0, let k be 0.\n      var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\n\n      function sameValueZero(x, y) {\n        return x === y || (typeof x === 'number' && typeof y === 'number' && isNaN(x) && isNaN(y));\n      }\n\n      // 7. Repeat, while k < len\n      while (k < len) {\n        // a. Let elementK be the result of ? Get(O, ! ToString(k)).\n        // b. If SameValueZero(valueToFind, elementK) is true, return true.\n        if (sameValueZero(o[k], valueToFind)) {\n          return true;\n        }\n        // c. Increase k by 1.\n        k++;\n      }\n\n      // 8. Return false\n      return false;\n    }\n  });\n}\nif (!String.prototype.includes) {\n  String.prototype.includes = function (search, start) {\n    'use strict';\n    if (typeof start !== 'number') {\n      start = 0;\n    }\n    if (start + search.length > this.length) {\n      return false;\n    } else {\n      return this.indexOf(search, start) !== -1;\n    }\n  };\n}\n\nif (!Array.prototype.find) {\n  Object.defineProperty(Array.prototype, 'find', {\n    value: function (predicate) {\n      // 1. Let O be ? ToObject(this value).\n      if (this == null) {\n        throw new TypeError('\"this\" is null or not defined');\n      }\n      var o = Object(this);\n      // 2. Let len be ? ToLength(? Get(O, \"length\")).\n      var len = o.length >>> 0;\n      // 3. If IsCallable(predicate) is false, throw a TypeError exception.\n      if (typeof predicate !== 'function') {\n        throw new TypeError('predicate must be a function');\n      }\n      // 4. If thisArg was supplied, let T be thisArg; else let T be undefined.\n      var thisArg = arguments[1];\n      // 5. Let k be 0.\n      var k = 0;\n      // 6. Repeat, while k < len\n      while (k < len) {\n        // a. Let Pk be ! ToString(k).\n        // b. Let kValue be ? Get(O, Pk).\n        // c. Let testResult be ToBoolean(? Call(predicate, T, « kValue, k, O »)).\n        // d. If testResult is true, return kValue.\n        var kValue = o[k];\n        if (predicate.call(thisArg, kValue, k, o)) {\n          return kValue;\n        }\n        // e. Increase k by 1.\n        k++;\n      }\n      // 7. Return undefined.\n      return void 0;\n    }\n  });\n}","/**\n * @param { unknown } param \n * @param { ...string } types \n * @return { boolean } \n */\nexport const isExpectType = (param: unknown, ...types: string[]): boolean => {\n  return types.some(\n    (type) =>\n      Object.prototype.toString.call(param).slice(8, -1).toLowerCase() === type\n  )\n}\n\nexport const get = (data: object, strKeys: string) => {\n  const keys = strKeys.split('.')\n  for (let key of keys) {\n    const res = data[key]\n    if (!isExpectType(res, 'object', 'array')) return res\n    data = res\n  }\n  return data\n}\n\nexport const has = (data: object, key: string | number): boolean => {\n  return Object.prototype.hasOwnProperty.call(data, key)\n}\n\n/**\n * clear \\n\n * @param { string } str\n * @return { string }\n */\nexport const removeEnter = (str: string): string => {\n  return [].filter.call(str, (s: any) => s !== '\\n').join('')\n}\n\n/** \n * @param num\n */\nexport const getNumber = (num: unknown): number => {\n  if (num === null) return 0\n  if (typeof num === 'object') return NaN\n  if (typeof num === 'number') return num\n  if (typeof num === 'string') {\n    if (num[num.length - 1] === '%') {\n      return Number(num.slice(0, -1)) / 100\n    }\n    return Number(num)\n  }\n  return NaN\n}\n\n/**\n * \n * @param color\n */\nexport const hasBackground = (color: string | undefined | null): boolean => {\n  if (typeof color !== 'string') return false\n  color = color.toLocaleLowerCase().trim()\n  if (color === 'transparent') return false\n  if (/^rgba/.test(color)) {\n    const alpha = /([^\\s,]+)\\)$/.exec(color)\n    if (getNumber(alpha) === 0) return false\n  }\n  return true\n}\n\n/**\n * @return { object } block\n */\nexport const computePadding = (\n  block: { padding?: string },\n  getLength: Function\n): [number, number, number, number] => {\n  let padding = block.padding?.split(' ').map((n) => getLength(n)) || [0],\n    paddingTop = 0,\n    paddingBottom = 0,\n    paddingLeft = 0,\n    paddingRight = 0\n  switch (padding.length) {\n    case 1:\n      paddingTop = paddingBottom = paddingLeft = paddingRight = padding[0]\n      break\n    case 2:\n      paddingTop = paddingBottom = padding[0]\n      paddingLeft = paddingRight = padding[1]\n      break\n    case 3:\n      paddingTop = padding[0]\n      paddingLeft = paddingRight = padding[1]\n      paddingBottom = padding[2]\n      break\n    default:\n      paddingTop = padding[0]\n      paddingBottom = padding[1]\n      paddingLeft = padding[2]\n      paddingRight = padding[3]\n  }\n\n  const res = { paddingTop, paddingBottom, paddingLeft, paddingRight }\n  for (let key in res) {\n    \n    res[key] =\n      has(block, key) && isExpectType(block[key], 'string', 'number')\n        ? getLength(block[key])\n        : res[key]\n  }\n  return [paddingTop, paddingBottom, paddingLeft, paddingRight]\n}\n\n/**\n\n * @param fn \n * @param wait\n * @returns\n */\nexport const throttle = (fn: Function, wait = 300) => {\n  let timeId = null as any\n  return function (this: any, ...args: any[]) {\n    if (timeId) return\n    timeId = setTimeout(() => {\n      fn.apply(this, args)\n      clearTimeout(timeId)\n      timeId = null\n    }, wait)\n  }\n}\n\n/**\n\n * @param { Array<number | undefined> } rangeArr \n * @returns { number } \n */\nexport const computeRange = (rangeArr: Array<number | undefined>): number => {\n  const ascendingArr: number[] = []\n  const sum = rangeArr\n    .map((num) => Number(num))\n    .reduce((prev, curr) => {\n      if (curr > 0) {\n        \n        const res = prev + curr\n        ascendingArr.push(res)\n        return res\n      } else {\n      \n        ascendingArr.push(NaN)\n        return prev\n      }\n    }, 0)\n  const random = Math.random() * sum\n  return ascendingArr.findIndex((num) => random <= num)\n}\n\n/**\n\n * @param text\n * @param maxWidth\n * @returns\n */\nexport const splitText = (\n  ctx: CanvasRenderingContext2D,\n  text: string,\n  getWidth: (lines: string[]) => number,\n  lineClamp: number = Infinity\n): string[] => {\n  if (lineClamp <= 0) lineClamp = Infinity\n  let str = ''\n  const lines = []\n  const EndWidth = ctx.measureText('...').width\n  for (let i = 0; i < text.length; i++) {\n    str += text[i]\n    let currWidth = ctx.measureText(str).width\n    const maxWidth = getWidth(lines)\n   \n    if (lineClamp === lines.length + 1) currWidth += EndWidth\n  \n    if (maxWidth < 0) return lines\n    \n    if (currWidth > maxWidth) {\n      lines.push(str.slice(0, -1))\n      str = text[i]\n    }\n    if (lineClamp === lines.length) {\n      lines[lines.length - 1] += '...'\n      return lines\n    }\n  }\n  if (str) lines.push(str)\n  if (!lines.length) lines.push(text)\n  return lines\n}\n\nexport const getSortedArrayByIndex = <T>(arr: T[], order: number[]): T[] => {\n  const map: { [key: number]: T } = {},\n    res = []\n  for (let i = 0; i < arr.length; i++) {\n    map[i] = arr[i]\n  }\n  for (let i = 0; i < order.length; i++) {\n    const curr = map[order[i]]\n    if (curr) res[i] = curr\n  }\n  return res\n}\n","import Watcher from './watcher'\n\nexport default class Dep {\n  static target: Watcher | null\n  private subs: Array<Watcher>\n\n  constructor () {\n    this.subs = []\n  }\n\n  /**\n   * @param {*} sub \n   */\n  public addSub (sub: Watcher) {\n    if (!this.subs.includes(sub)) {\n      this.subs.push(sub)\n    }\n  }\n  public notify () {\n    this.subs.forEach(sub => {\n      sub.update()\n    })\n  }\n}","import { isExpectType } from '../utils'\n\nexport const hasProto = '__proto__' in {}\n\nexport function def (obj: object, key: string | number, val: any, enumerable?: boolean) {\n  Object.defineProperty(obj, key, {\n    value: val,\n    enumerable: !!enumerable,\n    writable: true,\n    configurable: true\n  })\n}\n\nexport function parsePath (path: string) {\n  path += '.'\n  let segments: string[] = [], segment = ''\n  for (let i = 0; i < path.length; i++) {\n    let curr = path[i]\n    if (/\\[|\\./.test(curr)) {\n      segments.push(segment)\n      segment = ''\n    } else if (/\\W/.test(curr)) {\n      continue\n    } else {\n      segment += curr\n    }\n  }\n  return function (data: object | any[]) {\n    return segments.reduce((data, key) => {\n      return data[key]\n    }, data)\n  }\n}\n\nexport function traverse (value: any) {\n  // const seenObjects = new Set()\n  const dfs = (data: any) => {\n    if (!isExpectType(data, 'array', 'object')) return\n    Object.keys(data).forEach(key => {\n      const value = data[key]\n      dfs(value)\n    })\n  }\n  dfs(value)\n}","const oldArrayProto = Array.prototype\nconst newArrayProto = Object.create(oldArrayProto)\nconst methods = ['push', 'pop', 'shift', 'unshift', 'sort', 'splice', 'reverse']\nmethods.forEach(method => {\n  newArrayProto[method] = function (...args: any[]) {\n    const res = oldArrayProto[method].apply(this, args)\n    const luckyOb = this['__luckyOb__']\n    if (['push', 'unshift', 'splice'].includes(method)) luckyOb.walk(this)\n    luckyOb.dep.notify()\n    return res\n  }\n})\n\nexport { newArrayProto }","import Dep from './dep'\nimport { hasProto, def } from './utils'\nimport { newArrayProto } from './array'\n\nexport default class Observer {\n  value: any\n  dep: Dep\n\n  /**\n   * @param value \n   */\n  constructor (value: any) {\n\n    this.dep = new Dep()\n\n    def(value, '__luckyOb__', this)\n    if (Array.isArray(value)) {\n      if (hasProto) {\n        value['__proto__'] = newArrayProto\n      } else {\n        Object.getOwnPropertyNames(newArrayProto).forEach(key => {\n          def(value, key, newArrayProto[key])\n        })\n      }\n    }\n    this.walk(value)\n  }\n\n  walk (data: object | any[]) {\n    Object.keys(data).forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n}\n\n/**\n\n * @param { Object | Array } data\n */\nexport function observe (data: any): Observer | void {\n  if (!data || typeof data !== 'object') return\n  let luckyOb: Observer | void\n  if ('__luckyOb__' in data) {\n    luckyOb = data['__luckyOb__']\n  } else {\n    luckyOb = new Observer(data)\n  }\n  return luckyOb\n}\n\n/**\n * setter / getter\n * @param {*} data \n * @param {*} key \n * @param {*} val \n */\nexport function defineReactive (data: any, key: string | number, val: any) {\n  const dep = new Dep()\n  const property = Object.getOwnPropertyDescriptor(data, key)\n  if (property && property.configurable === false) {\n    return\n  }\n  const getter = property && property.get\n  const setter = property && property.set\n  if ((!getter || setter) && arguments.length === 2) {\n    val = data[key]\n  }\n  let childOb = observe(val)\n  Object.defineProperty(data, key, {\n    get: () => {\n      const value = getter ? getter.call(data) : val\n      if (Dep.target) {\n        dep.addSub(Dep.target)\n        if (childOb) {\n          childOb.dep.addSub(Dep.target)\n        }\n      }\n      return value\n    },\n    set: (newVal) => {\n      if (newVal === val) return\n      val = newVal\n      if (getter && !setter) return\n      if (setter) {\n        setter.call(data, newVal)\n      } else {\n        val = newVal\n      }\n      childOb = observe(newVal)\n      dep.notify()\n    }\n  })\n}","import Lucky from '../lib/lucky'\nimport Dep from './dep'\nimport { parsePath, traverse } from './utils'\n\nexport interface WatchOptType {\n  handler?: () => Function\n  immediate?: boolean\n  deep?: boolean\n}\n\nlet uid = 0\nexport default class Watcher {\n  id: number\n  $lucky: Lucky\n  expr: string | Function\n  cb: Function\n  deep: boolean\n  getter: Function\n  value: any\n\n  /**\n   * @param {*} $lucky \n   * @param {*} expr \n   * @param {*} cb \n   */\n  constructor ($lucky: Lucky, expr: string | Function, cb: Function, options: WatchOptType = {}) {\n    this.id = uid++\n    this.$lucky = $lucky\n    this.expr = expr\n    this.deep = !!options.deep\n    if (typeof expr === 'function') {\n      this.getter = expr\n    } else {\n      this.getter = parsePath(expr)\n    }\n    this.cb = cb\n    this.value = this.get()\n  }\n\n\n  get () {\n    Dep.target = this\n    const value = this.getter.call(this.$lucky, this.$lucky)\n    \n    if (this.deep) {\n      traverse(value)\n    }\n    Dep.target = null\n    return value\n  }\n\n  update () {\n    const newVal = this.get()\n    const oldVal = this.value\n    this.value = newVal\n    this.cb.call(this.$lucky, newVal, oldVal)\n  }\n}","import '../utils/polyfill'\nimport { has, isExpectType, throttle } from '../utils/index'\nimport {\n  ConfigType,\n  UserConfigType,\n  ImgItemType,\n  ImgType,\n} from '../types/index'\nimport { defineReactive } from '../observer'\nimport Watcher, { WatchOptType } from '../observer/watcher'\n\nexport default class Lucky {\n  protected readonly config: ConfigType\n  protected readonly ctx: CanvasRenderingContext2D\n  protected htmlFontSize: number = 16\n  protected rAF: Function = function () {}\n  protected boxWidth: number = 0\n  protected boxHeight: number = 0\n  protected data: {\n    width: string | number\n    height: string | number\n  }\n\n  /**\n   *\n   * @param config\n   */\n  constructor(\n    config: string | HTMLDivElement | UserConfigType,\n    data: {\n      width: string | number\n      height: string | number\n    }\n  ) {\n    if (typeof config === 'string') config = { el: config } as UserConfigType\n    else if (config.nodeType === 1)\n      config = { el: '', divElement: config } as UserConfigType\n    config = config as UserConfigType\n    this.config = config as ConfigType\n    this.data = data\n\n    if (!config.flag) config.flag = 'WEB'\n    if (config.el)\n      config.divElement = document.querySelector(config.el) as HTMLDivElement\n\n    if (config.divElement) {\n      config.canvasElement = document.createElement('canvas')\n      config.divElement.appendChild(config.canvasElement)\n    }\n    if (config.canvasElement) {\n      config.ctx = config.canvasElement.getContext('2d')!\n      config.canvasElement.setAttribute('package', `react-rotation-lucky-v1.1`)\n      config.canvasElement.addEventListener('click', (e) => this.handleClick(e))\n    }\n    this.ctx = config.ctx as CanvasRenderingContext2D\n    this.initWindowFunction()\n    if (!this.config.ctx) {\n      console.error('CanvasContext2D')\n    }\n    if (window && typeof window.addEventListener === 'function') {\n      window.addEventListener(\n        'resize',\n        throttle(() => this.resize(), 300)\n      )\n    }\n    if (window && typeof window.MutationObserver === 'function') {\n      new window.MutationObserver(() => {\n        this.resize()\n      }).observe(document.documentElement, { attributes: true })\n    }\n  }\n\n  protected resize(): void {\n    this.config.beforeResize?.()\n\n    this.setHTMLFontSize()\n\n    this.setDpr()\n\n    this.resetWidthAndHeight()\n    this.zoomCanvas()\n  }\n\n  protected initLucky() {\n    this.resize()\n    if (!this.boxWidth || !this.boxHeight) {\n      return console.error('This is not a valid')\n    }\n  }\n\n  protected handleClick(_e: MouseEvent): void {}\n\n  protected setHTMLFontSize(): void {\n    if (!window) return\n    this.htmlFontSize = +window\n      .getComputedStyle(document.documentElement)\n      .fontSize.slice(0, -2)\n  }\n\n  public clearCanvas(): void {\n    const [width, height] = [this.boxWidth, this.boxHeight]\n    this.ctx.clearRect(-width, -height, width * 2, height * 2)\n  }\n\n  protected setDpr(): void {\n    const { config } = this\n    if (config.dpr) {\n    } else if (window) {\n      window['dpr'] = config.dpr = window.devicePixelRatio || 1\n    } else if (!config.dpr) {\n      console.error(config, 'Error to set dpr')\n    }\n  }\n\n  private resetWidthAndHeight(): void {\n    const { config, data } = this\n\n    let boxWidth = 0,\n      boxHeight = 0\n    if (config.divElement) {\n      boxWidth = config.divElement.offsetWidth\n      boxHeight = config.divElement.offsetHeight\n    }\n    this.boxWidth = this.getLength(data.width || config['width']) || boxWidth\n    this.boxHeight =\n      this.getLength(data.height || config['height']) || boxHeight\n    if (config.divElement) {\n      config.divElement.style.overflow = 'hidden'\n      config.divElement.style.width = this.boxWidth + 'px'\n      config.divElement.style.height = this.boxHeight + 'px'\n    }\n  }\n\n  protected zoomCanvas(): void {\n    const { config, ctx } = this\n    const { canvasElement, dpr } = config\n    const [width, height] = [this.boxWidth * dpr, this.boxHeight * dpr]\n    if (!canvasElement) return\n    canvasElement.width = width\n    canvasElement.height = height\n    canvasElement.style.width = `${width}px`\n    canvasElement.style.height = `${height}px`\n    canvasElement.style['transform-origin'] = 'left top'\n    canvasElement.style.transform = `scale(${1 / dpr})`\n    ctx.scale(dpr, dpr)\n  }\n\n  private initWindowFunction(): void {\n    const { config } = this\n    if (window) {\n      this.rAF =\n        window.requestAnimationFrame ||\n        window['webkitRequestAnimationFrame'] ||\n        window['mozRequestAnimationFrame'] ||\n        function (callback: Function) {\n          window.setTimeout(callback, 1000 / 60)\n        }\n      config.setTimeout = window.setTimeout\n      config.setInterval = window.setInterval\n      config.clearTimeout = window.clearTimeout\n      config.clearInterval = window.clearInterval\n      return\n    }\n    if (config.rAF) {\n      this.rAF = config.rAF\n    } else if (config.setTimeout) {\n      const timeout = config.setTimeout\n      this.rAF = (callback: Function): number => timeout(callback, 16.7)\n    } else {\n      this.rAF = (callback: Function): number => setTimeout(callback, 16.7)\n    }\n  }\n\n  public isWeb() {\n    return ['WEB', 'UNI-H5', 'TARO-H5'].includes(this.config.flag)\n  }\n\n  /**\n   * @param src\n   * @param info\n   */\n  protected loadImg(\n    src: string,\n    info: ImgItemType,\n    resolveName = '$resolve'\n  ): Promise<ImgType> {\n    return new Promise((resolve, reject) => {\n      if (!src) reject(`=> '${info.src}' don't exist`)\n      if (this.config.flag === 'WEB') {\n        let imgObj = new Image()\n        imgObj['crossorigin'] = 'anonymous'\n        imgObj.onload = () => resolve(imgObj)\n        imgObj.onerror = () => reject(`=> '${info.src}' don't exist`)\n        imgObj.src = src\n      } else {\n        info[resolveName] = resolve\n        info['$reject'] = reject\n        return\n      }\n    })\n  }\n\n  /**\n   * @param imgObj\n   * @param rectInfo\n   */\n  protected drawImage(\n    ctx: CanvasRenderingContext2D,\n    imgObj: ImgType,\n    ...rectInfo: any\n  ): void {\n    let drawImg\n    const { flag, dpr } = this.config\n    if (['WEB', 'MP-WX'].includes(flag)) {\n      drawImg = imgObj\n    } else if (['UNI-H5', 'UNI-MP', 'TARO-H5', 'TARO-MP'].includes(flag)) {\n      type OldImageType = ImgType & { path: CanvasImageSource }\n      drawImg = (imgObj as OldImageType).path\n    } else {\n      return console.error('create flag, Pls check to the params!')\n    }\n    const miniProgramOffCtx = (drawImg['canvas'] || drawImg).getContext?.('2d')\n    if (miniProgramOffCtx && !this.isWeb()) {\n      rectInfo = rectInfo.map((val: any) => val! * dpr)\n      const temp = miniProgramOffCtx.getImageData(...rectInfo.slice(0, 4))\n      ctx.putImageData(temp, ...(rectInfo.slice(1, 6) as [number, 2]))\n    } else {\n      if (rectInfo.length === 8) {\n        rectInfo = rectInfo.map((val: any, index: number) =>\n          index < 4 ? val! * dpr : val\n        )\n      }\n      try {\n        ctx.drawImage(drawImg, ...((rectInfo as unknown) as [number, 8]))\n      } catch (err) {}\n    }\n  }\n\n  /**\n   * @param imgObj\n   * @param imgInfo\n   * @param maxWidth\n   * @param maxHeight\n   * @return\n   */\n  protected computedWidthAndHeight(\n    imgObj: ImgType,\n    imgInfo: ImgItemType,\n    maxWidth: number,\n    maxHeight: number\n  ): [number, number] {\n    if (!imgInfo.width && !imgInfo.height) {\n      return [imgObj.width, imgObj.height]\n    } else if (imgInfo.width && !imgInfo.height) {\n      let trueWidth = this.getLength(imgInfo.width, maxWidth)\n      return [trueWidth, imgObj.height * (trueWidth / imgObj.width)]\n    } else if (!imgInfo.width && imgInfo.height) {\n      let trueHeight = this.getLength(imgInfo.height, maxHeight)\n\n      return [imgObj.width * (trueHeight / imgObj.height), trueHeight]\n    }\n\n    return [\n      this.getLength(imgInfo.width, maxWidth),\n      this.getLength(imgInfo.height, maxHeight)\n    ]\n  }\n\n  /**\n   * @param { string } value\n   * @param { number } denominator\n   * @return { number }\n   */\n  protected changeUnits(value: string, denominator = 1): number {\n    const { config } = this\n    return Number(\n      value.replace(/^([-]*[0-9.]*)([a-z%]*)$/, (_val, num, unit) => {\n        const handleCssUnit = {\n          '%': (n: number) => n * (denominator / 100),\n          px: (n: number) => n * 1,\n          rem: (n: number) => n * this.htmlFontSize,\n          vw: (n: number) => (n / 100) * window.innerWidth\n        }[unit]\n        if (handleCssUnit) return handleCssUnit(num)\n        const otherHandleCssUnit = config.handleCssUnit || config['unitFunc']\n        return otherHandleCssUnit ? otherHandleCssUnit(num, unit) : num\n      })\n    )\n  }\n\n  /**\n   * @param length\n   * @param maxLength\n   * @return\n   */\n  protected getLength(\n    length: string | number | undefined,\n    maxLength?: number\n  ): number {\n    if (isExpectType(length, 'number')) return length as number\n    if (isExpectType(length, 'string'))\n      return this.changeUnits(length as string, maxLength)\n    return 0\n  }\n\n  /**\n   * @param width\n   * @param col\n   */\n  protected getOffsetX(width: number, maxWidth: number = 0): number {\n    return (maxWidth - width) / 2\n  }\n\n  protected getOffscreenCanvas(\n    width: number,\n    height: number\n  ): {\n    _offscreenCanvas: HTMLCanvasElement\n    _ctx: CanvasRenderingContext2D\n  } | void {\n    if (!has(this, '_offscreenCanvas')) {\n      if (window && window.document && this.config.flag === 'WEB') {\n        this['_offscreenCanvas'] = document.createElement('canvas')\n      } else {\n        this['_offscreenCanvas'] = this.config['offscreenCanvas']\n      }\n      if (!this['_offscreenCanvas'])\n        return console.error(' Canvas do not support!')\n    }\n    const dpr = this.config.dpr\n    const _offscreenCanvas = this['_offscreenCanvas'] as HTMLCanvasElement\n    _offscreenCanvas.width = (width || 300) * dpr\n    _offscreenCanvas.height = (height || 150) * dpr\n    const _ctx = _offscreenCanvas.getContext('2d')!\n    _ctx.clearRect(0, 0, width, height)\n    _ctx.scale(dpr, dpr)\n    _ctx['dpr'] = dpr\n    return { _offscreenCanvas, _ctx }\n  }\n\n  /**\n   * @param data\n   * @param key\n   * @param value\n   */\n  public $set(data: object, key: string | number, value: any) {\n    if (!data || typeof data !== 'object') return\n    defineReactive(data, key, value)\n  }\n\n  /**\n \n   * @param data \n   * @param key \n   * @param callback \n   */\n  protected $computed(data: object, key: string, callback: Function) {\n    Object.defineProperty(data, key, {\n      get: () => {\n        return callback.call(this)\n      }\n    })\n  }\n\n  /**\n   * create user watcher\n   * @param expr\n   * @param handler\n   * @param watchOpt\n   * @return\n   */\n  protected $watch(\n    expr: string | Function,\n    handler: Function | WatchOptType,\n    watchOpt: WatchOptType = {}\n  ): Function {\n    if (typeof handler === 'object') {\n      watchOpt = handler\n      handler = watchOpt.handler!\n    }\n    // user watcher\n    const watcher = new Watcher(this, expr, handler, watchOpt)\n    if (watchOpt.immediate) {\n      handler.call(this, watcher.value)\n    }\n    return function unWatchFn() {}\n  }\n}\n","export const getAngle = (deg: number): number => {\n  return Math.PI / 180 * deg\n}\n\n/**\n * @param { number } deg \n * @param { number } r \n * @return { Array<number> }\n */\nexport const getArcPointerByDeg = (deg: number, r: number): [number, number] => {\n  return [+(Math.cos(deg) * r).toFixed(8), +(Math.sin(deg) * r).toFixed(8)]\n}\n\n/**\n *\n * @param { number } x\n * @param { number } y \n * @return { Array<number> } \n */\nexport const getTangentByPointer = (x: number, y: number): Array<number> => {\n  let k = - x / y\n  let b = -k * x + y\n  return [k, b]\n}\n\nexport const fanShapedByArc = (\n  ctx: CanvasRenderingContext2D,\n  _minRadius: number,\n  maxRadius: number,\n  start: number,\n  end: number,\n  gutter: number,\n): void => {\n  ctx.beginPath()\n  let maxGutter = getAngle(90 / Math.PI / maxRadius * gutter)\n  let maxStart = start + maxGutter\n  let maxEnd = end - maxGutter\n  ctx.arc(0, 0, maxRadius, maxStart, maxEnd, false)\n    ctx.lineTo(\n      ...getArcPointerByDeg(\n        (start + end) / 2,\n        gutter / 2 / Math.abs(Math.sin((start - end) / 2))\n      )\n    )\n  ctx.closePath()\n}\nexport const roundRectByArc = (\n  ctx: CanvasRenderingContext2D,\n  ...[x, y, w, h, r]: number[]\n) => {\n  const min = Math.min(w, h), PI = Math.PI\n  if (r > min / 2) r = min / 2\n  ctx.beginPath()\n  ctx.moveTo(x + r, y)\n  ctx.lineTo(x + r, y)\n  ctx.lineTo(x + w - r, y)\n  ctx.arc(x + w - r, y + r, r, -PI / 2, 0)\n  ctx.lineTo(x + w, y + h - r)\n  ctx.arc(x + w - r, y + h - r, r, 0, PI / 2)\n  ctx.lineTo(x + r, y + h)\n  ctx.arc(x + r, y + h - r, r, PI / 2, PI)\n  ctx.lineTo(x, y + r)\n  ctx.arc(x + r, y + r, r, PI, -PI / 2)\n  ctx.closePath()\n}\n\nexport const getLinearGradient = (\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n  background: string\n) => {\n  const context = (/linear-gradient\\((.+)\\)/.exec(background) as Array<any>)[1]\n    .split(',')\n    .map((text: string) => text.trim()) \n  let deg = context.shift(), direction: [number, number, number, number] = [0, 0, 0, 0]\n\n  if (deg.includes('deg')) {\n    deg = deg.slice(0, -3) % 360\n\n    const getLenOfTanDeg = (deg: number) => Math.tan(deg / 180 * Math.PI)\n    if (deg >= 0 && deg < 45) direction = [x, y + h, x + w, y + h - w * getLenOfTanDeg(deg - 0)]\n    else if (deg >= 45 && deg < 90) direction = [x, y + h, (x + w) - h * getLenOfTanDeg(deg - 45), y]\n    else if (deg >= 90 && deg < 135) direction = [x + w, y + h, (x + w) - h * getLenOfTanDeg(deg - 90), y]\n    else if (deg >= 135 && deg < 180) direction = [x + w, y + h, x, y + w * getLenOfTanDeg(deg - 135)]\n    else if (deg >= 180 && deg < 225) direction = [x + w, y, x, y + w * getLenOfTanDeg(deg - 180)]\n    else if (deg >= 225 && deg < 270) direction = [x + w, y, x + h * getLenOfTanDeg(deg - 225), y + h]\n    else if (deg >= 270 && deg < 315) direction = [x, y, x + h * getLenOfTanDeg(deg - 270), y + h]\n    else if (deg >= 315 && deg < 360) direction = [x, y, x + w, y + h - w * getLenOfTanDeg(deg - 315)]\n  }\n  else if (deg.includes('top')) direction = [x, y + h, x, y]\n  else if (deg.includes('bottom')) direction = [x, y, x, y + h]\n  else if (deg.includes('left')) direction = [x + w, y, x, y]\n  else if (deg.includes('right')) direction = [x, y, x + w, y]\n\n  const gradient = ctx.createLinearGradient(...(direction.map(n => n >> 0) as typeof direction))\n  return context.reduce((gradient: any, item: any, index: any) => {\n    const info = item.split(' ')\n    if (info.length === 1) gradient.addColorStop(index, info[0])\n    else if (info.length === 2) gradient.addColorStop(...info)\n    return gradient\n  }, gradient)\n}\n","interface SpeedType {\n  easeIn: (...arr: number[]) => number\n  easeOut: (...arr: number[]) => number\n}\n\nexport const quad: SpeedType = {\n  easeIn: function (t, b, c, d) {\n    if (t >= d) t = d\n    return c * (t /= d) * t + b\n  },\n  easeOut: function (t, b, c, d) {\n    if (t >= d) t = d\n    return -c * (t /= d) * (t - 2) + b\n  }\n}\n\nexport const cubic: SpeedType = {\n  easeIn: function (t, b, c, d) {\n    if (t >= d) t = d\n    return c * (t /= d) * t * t + b\n  },\n  easeOut: function (t, b, c, d) {\n    if (t >= d) t = d\n    return c * ((t = t / d - 1) * t * t + 1) + b\n  }\n}\n\nexport const quart: SpeedType = {\n  easeIn: function (t, b, c, d) {\n    if (t >= d) t = d\n    return c * (t /= d) * t * t * t + b\n  },\n  easeOut: function (t, b, c, d) {\n    if (t >= d) t = d\n    return -c * ((t = t / d - 1) * t * t * t - 1) + b\n  }\n}\n\nexport const quint: SpeedType = {\n  easeIn: function (t, b, c, d) {\n    if (t >= d) t = d\n    return c * (t /= d) * t * t * t * t + b\n  },\n  easeOut: function (t, b, c, d) {\n    if (t >= d) t = d\n    return c * ((t = t / d - 1) * t * t * t * t + 1) + b\n  }\n}\n\nexport const sine: SpeedType = {\n  easeIn: function (t, b, c, d) {\n    if (t >= d) t = d\n    return -c * Math.cos(t / d * (Math.PI / 2)) + c + b\n  },\n  easeOut: function (t, b, c, d) {\n    if (t >= d) t = d\n    return c * Math.sin(t / d * (Math.PI / 2)) + b\n  }\n}\n\n\nexport const expo: SpeedType = {\n  easeIn: function (t, b, c, d) {\n    if (t >= d) t = d\n    return (t == 0) ? b : c * Math.pow(2, 10 * (t / d - 1)) + b\n  },\n  easeOut: function (t, b, c, d) {\n    if (t >= d) t = d\n    return (t == d) ? b + c : c * (-Math.pow(2, -10 * t / d) + 1) + b\n  }\n}\n\nexport const circ: SpeedType = {\n  easeIn: function (t, b, c, d) {\n    if (t >= d) t = d\n    return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b\n  },\n  easeOut: function (t, b, c, d) {\n    if (t >= d) t = d\n    return c * Math.sqrt(1 - (t = t / d - 1) * t) + b\n  }\n}","import Lucky from './lucky'\nimport { UserConfigType, FontItemType } from '../types/index'\nimport LuckyWheelConfig, {\n  BlockType,\n  PrizeType,\n  ButtonType,\n  DefaultConfigType,\n  DefaultStyleType,\n  StartCallbackType,\n  EndCallbackType\n} from '../types/wheel'\nimport {\n  removeEnter,\n  hasBackground,\n  computeRange,\n  splitText,\n  has\n} from '../utils/index'\nimport { getAngle, fanShapedByArc } from '../utils/math'\nimport { quad } from '../utils/tween'\n\nexport default class LuckyWheel extends Lucky {\n  private blocks: Array<BlockType> = []\n  private prizes: Array<PrizeType> = []\n  private buttons: Array<ButtonType> = []\n  private defaultConfig: DefaultConfigType = {}\n  private defaultStyle: DefaultStyleType = {}\n  private _defaultConfig: Required<DefaultConfigType> = {} as Required<\n    DefaultConfigType\n  >\n  private _defaultStyle: Required<DefaultStyleType> = {} as Required<\n    DefaultStyleType\n  >\n  private startCallback?: StartCallbackType\n  private endCallback?: EndCallbackType\n  private Radius = 0 \n  private prizeRadius = 0 \n  private prizeDeg = 0 \n  private prizeAng = 0 \n  private rotateDeg = 0 \n  private maxBtnRadius = 0 \n  private startTime = 0 \n  private endTime = 0 \n  private stopDeg = 0 \n  private endDeg = 0 \n  private FPS = 16.6 \n\n  private step: 0 | 1 | 2 | 3 = 0\n\n  private prizeFlag: number | undefined\n  private ImageCache = new Map()\n  static defaultProps: { width: string; height: string; prizes: never[]; blocks: never[]; buttons: never[]; defaultStyle: {}; defaultConfig: {} }\n\n  /**\n   * @param config \n   * @param data \n   */\n  constructor(config: UserConfigType, data: LuckyWheelConfig) {\n    super(config, {\n      width: data.width,\n      height: data.height\n    })\n    this.initData(data)\n    this.initWatch()\n    this.initComputed()\n    config.beforeCreate?.call(this)\n    this.init()\n  }\n\n  protected resize(): void {\n    super.resize()\n    this.Radius = Math.min(this.boxWidth, this.boxHeight) / 2\n    this.ctx.translate(this.Radius, this.Radius)\n    this.draw()\n    this.config.afterResize?.()\n  }\n\n  protected initLucky(): void {\n    this.Radius = 0\n    this.prizeRadius = 0\n    this.prizeDeg = 0\n    this.prizeAng = 0\n    this.rotateDeg = 0\n    this.maxBtnRadius = 0\n    this.startTime = 0\n    this.endTime = 0\n    this.stopDeg = 0\n    this.endDeg = 0\n    this.FPS = 16.6\n    this.prizeFlag = -1\n    this.step = 0\n    super.initLucky()\n  }\n\n\n  private initData(data: LuckyWheelConfig): void {\n    this.$set(this, 'width', data.width)\n    this.$set(this, 'height', data.height)\n    this.$set(this, 'blocks', data.blocks || [])\n    this.$set(this, 'prizes', data.prizes || [])\n    this.$set(this, 'buttons', data.buttons || [])\n    this.$set(this, 'defaultConfig', data.defaultConfig || {})\n    this.$set(this, 'defaultStyle', data.defaultStyle || {})\n    this.$set(this, 'startCallback', data.start)\n    this.$set(this, 'endCallback', data.end)\n  }\n\n\n  private initComputed() {\n    \n    this.$computed(this, '_defaultConfig', () => {\n      const config = {\n        gutter: '0px',\n        offsetDegree: 0,\n        speed: 20,\n        speedFunction: 'quad',\n        accelerationTime: 2500,\n        decelerationTime: 2500,\n        stopRange: 0,\n        ...this.defaultConfig\n      }\n      return config\n    })\n    this.$computed(this, '_defaultStyle', () => {\n      const style = {\n        fontSize: '18px',\n        fontColor: '#000',\n        fontStyle: 'sans-serif',\n        fontWeight: '400',\n        background: 'rgba(0,0,0,0)',\n        wordWrap: true,\n        lengthLimit: '90%',\n        ...this.defaultStyle\n      }\n      return style\n    })\n  }\n\n  private initWatch() {\n    this.$watch('width', (newVal: string | number) => {\n      this.data.width = newVal\n      this.resize()\n    })\n    this.$watch('height', (newVal: string | number) => {\n      this.data.height = newVal\n      this.resize()\n    })\n    // create blocks\n    this.$watch(\n      'blocks',\n      (_newData: Array<BlockType>) => {\n        this.initImageCache()\n      },\n      { deep: true }\n    )\n    // prizes\n    this.$watch(\n      'prizes',\n      (_newData: Array<PrizeType>) => {\n        this.initImageCache()\n      },\n      { deep: true }\n    )\n    //  buttons spinning\n    this.$watch(\n      'buttons',\n      (_newData: Array<ButtonType>) => {\n        this.initImageCache()\n      },\n      { deep: true }\n    )\n    this.$watch('defaultConfig', () => this.draw(), { deep: true })\n    this.$watch('defaultStyle', () => this.draw(), { deep: true })\n    this.$watch('startCallback', () => this.init())\n    this.$watch('endCallback', () => this.init())\n  }\n\n  /**\n   * init canvas\n   */\n  public async init(): Promise<void> {\n    this.initLucky()\n    const { config } = this\n    config.beforeInit?.call(this)\n    this.draw()\n    this.draw()\n    await this.initImageCache()\n\n    config.afterInit?.call(this)\n  }\n\n  private initImageCache(): Promise<void> {\n    return new Promise((resolve) => {\n      const willUpdateImgs = {\n        blocks: this.blocks.map((block) => block.imgs),\n        prizes: this.prizes.map((prize) => prize.imgs),\n        buttons: this.buttons.map((btn) => btn.imgs)\n      }\n      ;(<(keyof typeof willUpdateImgs)[]>Object.keys(willUpdateImgs)).forEach(\n        (imgName) => {\n          const willUpdate = willUpdateImgs[imgName]\n          const allPromise: Promise<void>[] = []\n          willUpdate &&\n            willUpdate.forEach((imgs, cellIndex) => {\n              imgs &&\n                imgs.forEach((_imgInfo, imgIndex) => {\n                  allPromise.push(\n                    this.loadAndCacheImg(imgName, cellIndex, imgIndex)\n                  )\n                })\n            })\n          Promise.all(allPromise).then(() => {\n            this.draw()\n            resolve()\n          })\n        }\n      )\n    })\n  }\n\n  /**\n   * canvas click handler\n   * @param e\n   */\n  protected handleClick(e: MouseEvent): void {\n    const { ctx } = this\n    ctx.beginPath()\n    ctx.arc(0, 0, this.maxBtnRadius, 0, Math.PI * 2, false)\n    if (!ctx.isPointInPath(e.offsetX, e.offsetY)) return\n    if (this.step !== 0) return\n    this.startCallback?.(e)\n  }\n\n  /**\n   * @param cellName\n   * @param cellIndex\n   * @param imgName\n   * @param imgIndex\n   */\n  private async loadAndCacheImg(\n    cellName: 'blocks' | 'prizes' | 'buttons',\n    cellIndex: number,\n    imgIndex: number\n  ): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const cell: BlockType | PrizeType | ButtonType = this[cellName][cellIndex]\n      if (!cell || !cell.imgs) return\n      const imgInfo = cell.imgs[imgIndex]\n      if (!imgInfo) return\n      this.loadImg(imgInfo.src, imgInfo)\n        .then(async (currImg) => {\n          if (typeof imgInfo.formatter === 'function') {\n            currImg = await Promise.resolve(\n              imgInfo.formatter.call(this, currImg)\n            )\n          }\n          this.ImageCache.set(imgInfo['src'], currImg)\n          resolve()\n        })\n        .catch((err) => {\n          console.error(`${cellName}[${cellIndex}].imgs[${imgIndex}] ${err}`)\n          reject()\n        })\n    })\n  }\n\n  private drawBlock(\n    radius: number,\n    block: BlockType,\n    _blockIndex: number\n  ): void {\n    const { ctx } = this\n    if (hasBackground(block.background)) {\n      ctx.beginPath()\n      ctx.fillStyle = block.background!\n      ctx.arc(0, 0, radius, 0, Math.PI * 2, false)\n      ctx.fill()\n    }\n    block.imgs &&\n      block.imgs.forEach((imgInfo, _imgIndex) => {\n        const blockImg = this.ImageCache.get(imgInfo.src)\n        if (!blockImg) return\n        const [trueWidth, trueHeight] = this.computedWidthAndHeight(\n          blockImg,\n          imgInfo,\n          radius * 2,\n          radius * 2\n        )\n        const [xAxis, yAxis] = [\n          this.getOffsetX(trueWidth) + this.getLength(imgInfo.left, radius * 2),\n          this.getLength(imgInfo.top, radius * 2) - radius\n        ]\n        ctx.save()\n        imgInfo.rotate && ctx.rotate(getAngle(this.rotateDeg))\n        this.drawImage(ctx, blockImg, xAxis, yAxis, trueWidth, trueHeight)\n        ctx.restore()\n      })\n  }\n\n  protected draw(): void {\n    const { config, ctx, _defaultConfig, _defaultStyle } = this\n\n    config.beforeDraw?.call(this, ctx)\n\n    ctx.clearRect(-this.Radius, -this.Radius, this.Radius * 2, this.Radius * 2)\n\n    this.prizeRadius = this.blocks.reduce((radius, block, blockIndex) => {\n      this.drawBlock(radius, block, blockIndex)\n      return (\n        radius - this.getLength(block.padding && block.padding.split(' ')[0])\n      )\n    }, this.Radius)\n\n    this.prizeDeg = 360 / this.prizes.length\n    this.prizeAng = getAngle(this.prizeDeg)\n    const shortSide = this.prizeRadius * Math.sin(this.prizeAng / 2) * 2\n\n    let start = getAngle(\n      this.rotateDeg - 90 + this.prizeDeg / 2 + _defaultConfig.offsetDegree\n    )\n\n    const getFontX = (font: FontItemType, line: string) => {\n      return (\n        this.getOffsetX(ctx.measureText(line).width) +\n        this.getLength(font.left, shortSide)\n      )\n    }\n\n    const getFontY = (\n      font: FontItemType,\n      height: number,\n      lineIndex: number\n    ) => {\n      const lineHeight =\n        font.lineHeight ||\n        _defaultStyle.lineHeight ||\n        font.fontSize ||\n        _defaultStyle.fontSize\n      return (\n        this.getLength(font.top, height) +\n        (lineIndex + 1) * this.getLength(lineHeight)\n      )\n    }\n    ctx.save()\n\n    this.prizes.forEach((prize, prizeIndex) => {\n      let currMiddleDeg = start + prizeIndex * this.prizeAng\n\n      let prizeHeight = this.prizeRadius - this.maxBtnRadius\n\n      const background = prize.background || _defaultStyle.background\n      if (hasBackground(background)) {\n        ctx.fillStyle = background\n        fanShapedByArc(\n          ctx,\n          this.maxBtnRadius,\n          this.prizeRadius,\n          currMiddleDeg - this.prizeAng / 2,\n          currMiddleDeg + this.prizeAng / 2,\n          this.getLength(_defaultConfig.gutter)\n        )\n        ctx.fill()\n      }\n      let x = Math.cos(currMiddleDeg) * this.prizeRadius\n      let y = Math.sin(currMiddleDeg) * this.prizeRadius\n      ctx.translate(x, y)\n      ctx.rotate(currMiddleDeg + getAngle(90))\n      prize.imgs &&\n        prize.imgs.forEach((imgInfo, _imgIndex) => {\n          const prizeImg = this.ImageCache.get(imgInfo.src)\n          if (!prizeImg) return\n          const [trueWidth, trueHeight] = this.computedWidthAndHeight(\n            prizeImg,\n            imgInfo,\n            this.prizeAng * this.prizeRadius,\n            prizeHeight\n          )\n          const [xAxis, yAxis] = [\n            this.getOffsetX(trueWidth) +\n              this.getLength(imgInfo.left, shortSide),\n            this.getLength(imgInfo.top, prizeHeight)\n          ]\n          this.drawImage(ctx, prizeImg, xAxis, yAxis, trueWidth, trueHeight)\n        })\n      prize.fonts &&\n        prize.fonts.forEach((font) => {\n          const fontColor = font.fontColor || _defaultStyle.fontColor\n          const fontWeight = font.fontWeight || _defaultStyle.fontWeight\n          const fontSize = this.getLength(\n            font.fontSize || _defaultStyle.fontSize\n          )\n          const fontStyle = font.fontStyle || _defaultStyle.fontStyle\n          const wordWrap = has(font, 'wordWrap')\n            ? font.wordWrap\n            : _defaultStyle.wordWrap\n          const lengthLimit = font.lengthLimit || _defaultStyle.lengthLimit\n          const lineClamp = font.lineClamp || _defaultStyle.lineClamp\n          ctx.fillStyle = fontColor\n          ctx.font = `${fontWeight} ${fontSize >> 0}px ${fontStyle}`\n          let lines = [],\n            text = String(font.text)\n          if (wordWrap) {\n            lines = splitText(\n              ctx,\n              removeEnter(text),\n              (lines) => {\n                const adjacentSide =\n                  this.prizeRadius - getFontY(font, prizeHeight, lines.length)\n                const shortSide = adjacentSide * Math.tan(this.prizeAng / 2)\n                let maxWidth =\n                  shortSide * 2 - this.getLength(_defaultConfig.gutter)\n                return this.getLength(lengthLimit, maxWidth)\n              },\n              lineClamp\n            )\n          } else {\n            lines = text.split('\\n')\n          }\n          lines\n            .filter((line) => !!line)\n            .forEach((line, lineIndex) => {\n              ctx.fillText(\n                line,\n                getFontX(font, line),\n                getFontY(font, prizeHeight, lineIndex)\n              )\n            })\n        })\n      ctx.rotate(getAngle(360) - currMiddleDeg - getAngle(90))\n      ctx.translate(-x, -y)\n    })\n    ctx.restore()\n    this.buttons.forEach((btn, _btnIndex) => {\n      let radius = this.getLength(btn.radius, this.prizeRadius)\n      this.maxBtnRadius = Math.max(this.maxBtnRadius, radius)\n      if (hasBackground(btn.background)) {\n        ctx.beginPath()\n        ctx.fillStyle = btn.background as string\n        ctx.arc(0, 0, radius, 0, Math.PI * 2, false)\n        ctx.fill()\n      }\n      if (btn.pointer && hasBackground(btn.background)) {\n        ctx.beginPath()\n        ctx.fillStyle = btn.background as string\n        ctx.moveTo(-radius, 0)\n        ctx.lineTo(radius, 0)\n        ctx.lineTo(0, -radius * 2)\n        ctx.closePath()\n        ctx.fill()\n      }\n      btn.imgs &&\n        btn.imgs.forEach((imgInfo, _imgIndex) => {\n          const btnImg = this.ImageCache.get(imgInfo.src)\n          if (!btnImg) return\n          const [trueWidth, trueHeight] = this.computedWidthAndHeight(\n            btnImg,\n            imgInfo,\n            radius * 2,\n            radius * 2\n          )\n          const [xAxis, yAxis] = [\n            this.getOffsetX(trueWidth) + this.getLength(imgInfo.left, radius),\n            this.getLength(imgInfo.top, radius)\n          ]\n          this.drawImage(ctx, btnImg, xAxis, yAxis, trueWidth, trueHeight)\n        })\n      btn.fonts &&\n        btn.fonts.forEach((font) => {\n          let fontColor = font.fontColor || _defaultStyle.fontColor\n          let fontWeight = font.fontWeight || _defaultStyle.fontWeight\n          let fontSize = this.getLength(font.fontSize || _defaultStyle.fontSize)\n          let fontStyle = font.fontStyle || _defaultStyle.fontStyle\n          ctx.fillStyle = fontColor\n          ctx.font = `${fontWeight} ${fontSize >> 0}px ${fontStyle}`\n          String(font.text)\n            .split('\\n')\n            .forEach((line, lineIndex) => {\n              ctx.fillText(\n                line,\n                getFontX(font, line),\n                getFontY(font, radius, lineIndex)\n              )\n            })\n        })\n    })\n    config.afterDraw?.call(this, ctx)\n  }\n\n  private carveOnGunwaleOfAMovingBoat(): void {\n    const { _defaultConfig, prizeFlag, prizeDeg, rotateDeg } = this\n    this.endTime = Date.now()\n    const stopDeg = (this.stopDeg = rotateDeg)\n    const speed = _defaultConfig.speed\n    const stopRange =\n      (Math.random() * prizeDeg - prizeDeg / 2) *\n      this.getLength(_defaultConfig.stopRange)\n    let i = 0,\n      prevSpeed = 0,\n      prevDeg = 0\n    while (++i) {\n      const endDeg =\n        360 * i -\n        prizeFlag! * prizeDeg -\n        rotateDeg -\n        _defaultConfig.offsetDegree +\n        stopRange -\n        prizeDeg / 2\n      let currSpeed =\n        quad.easeOut(\n          this.FPS,\n          stopDeg,\n          endDeg,\n          _defaultConfig.decelerationTime\n        ) - stopDeg\n      if (currSpeed > speed) {\n        this.endDeg = speed - prevSpeed > currSpeed - speed ? endDeg : prevDeg\n        break\n      }\n      prevDeg = endDeg\n      prevSpeed = currSpeed\n    }\n  }\n\n  public play(): void {\n    if (this.step !== 0) return\n\n    this.startTime = Date.now()\n\n    this.prizeFlag = void 0\n\n    this.step = 1\n\n    this.config.afterStart?.()\n\n    this.run()\n  }\n\n  /**\n   * @param index\n   */\n  public stop(index?: number): void {\n    if (this.step === 0 || this.step === 3) return\n    if (!index && index !== 0) {\n      const rangeArr = this.prizes.map((item) => item.range)\n      index = computeRange(rangeArr)\n    }\n    if (index < 0) {\n      this.step = 0\n      this.prizeFlag = -1\n    } else {\n      this.step = 2\n      this.prizeFlag = index % this.prizes.length\n    }\n  }\n\n  /**\n   * @param num\n   */\n  private run(num: number = 0): void {\n    const { rAF, step, prizeFlag, _defaultConfig } = this\n    const { accelerationTime, decelerationTime, speed } = _defaultConfig\n\n    if (step === 0) {\n      this.endCallback?.(\n        this.prizes.find((_prize, index) => index === prizeFlag) || {}\n      )\n      return\n    }\n\n    if (prizeFlag === -1) return\n\n    if (step === 3 && !this.endDeg) this.carveOnGunwaleOfAMovingBoat()\n\n    const startInterval = Date.now() - this.startTime\n    const endInterval = Date.now() - this.endTime\n    let rotateDeg = this.rotateDeg\n    //\n    if (step === 1 || startInterval < accelerationTime) {\n      this.FPS = startInterval / num\n      const currSpeed = quad.easeIn(startInterval, 0, speed, accelerationTime)\n\n      if (currSpeed === speed) {\n        this.step = 2\n      }\n      rotateDeg = rotateDeg + (currSpeed % 360)\n    } else if (step === 2) {\n      rotateDeg = rotateDeg + (speed % 360)\n\n      if (prizeFlag !== void 0 && prizeFlag >= 0) {\n        this.step = 3\n        this.stopDeg = 0\n        this.endDeg = 0\n      }\n    } else if (step === 3) {\n      rotateDeg = quad.easeOut(\n        endInterval,\n        this.stopDeg,\n        this.endDeg,\n        decelerationTime\n      )\n      if (endInterval >= decelerationTime) {\n        this.step = 0\n      }\n    } else {\n      this.stop(-1)\n    }\n    this.rotateDeg = rotateDeg\n    this.draw()\n    rAF(this.run.bind(this, num + 1))\n  }\n\n  /**\n   * @param x\n   * @param y\n   */\n  protected conversionAxis(x: number, y: number): [number, number] {\n    const { config } = this\n    return [x / config.dpr - this.Radius, y / config.dpr - this.Radius]\n  }\n}\n","import React from 'react'\nimport LuckyWheel from './lib/wheel'\nimport LuckyWheelConfig, {\n  BlockType,\n  PrizeType,\n  ButtonType\n} from './types/wheel'\n\ninterface TProps {\n  onSuccess?: Function\n  onError?: Function\n  onFinally?: Function\n  width: number\n  height: number\n  blocks?: Array<BlockType>\n  prizes?: Array<PrizeType>\n  buttons?: Array<ButtonType>\n  onStart: Function\n  onEnd: Function\n}\nexport default class LuckyWheelComponent extends React.Component<TProps> {\n  myLucky: React.RefObject<any>\n  lucky: any\n  constructor(props: any) {\n    super(props)\n    this.myLucky = React.createRef()\n    this.lucky = undefined\n  }\n  componentDidMount() {\n    // 当前已经有实例时，不再进行，解决在`react18 + strictMode`下组件componentDidMount会被触发两次的问题\n    if (this.lucky) {\n      return\n    }\n    this.myLucky.current.setAttribute('package', `react-rotation-lucky@v1.1.0`)\n    try {\n      this.initLucky()\n      this?.props?.onSuccess && this.props?.onSuccess()\n    } catch (err) {\n      this?.props?.onError && this?.props?.onError(err)\n    } finally {\n      this.props?.onFinally && this?.props?.onFinally()\n    }\n  }\n  componentDidUpdate(prevProps: {\n    width: number\n    height: number\n    blocks?: Array<BlockType>\n    prizes?: Array<PrizeType>\n    buttons?: Array<ButtonType>\n  }) {\n    if (!this.lucky) return\n    if (this.props.width !== prevProps.width) {\n      this.lucky.width = this.props.width\n    }\n    if (this.props.height !== prevProps.height) {\n      this.lucky.height = this.props.height\n    }\n    if (this.props.blocks !== prevProps.blocks) {\n      this.lucky.blocks = this.props.blocks\n    }\n    if (this.props.prizes !== prevProps.prizes) {\n      this.lucky.prizes = this.props.prizes\n    }\n    if (this.props.buttons !== prevProps.buttons) {\n      this.lucky.buttons = this.props.buttons\n    }\n  }\n  initLucky() {\n    this.lucky = new LuckyWheel(\n      {\n        flag: 'WEB',\n        divElement: this.myLucky.current\n      },\n      ({\n        ...this.props,\n        start: (...rest: any) => {\n          this.props.onStart && this.props.onStart(...rest)\n        },\n        end: (...rest: any) => {\n          this.props.onEnd && this.props.onEnd(...rest)\n        }\n      } as unknown) as LuckyWheelConfig\n    )\n  }\n  init(...rest: any[]) {\n    this.lucky.init(...rest)\n  }\n  play(...rest: any[]) {\n    this.lucky.play(...rest)\n  }\n  stop(...rest: any[]) {\n    this.lucky.stop(...rest)\n  }\n  render() {\n    return <div ref={this.myLucky}></div>\n  }\n}\n\nLuckyWheel.defaultProps = {\n  width: '',\n  height: '',\n  prizes: [],\n  blocks: [],\n  buttons: [],\n  defaultStyle: {},\n  defaultConfig: {}\n}\n\n// import { WheelData } from './typings'\n// interface WheelProps {\n//   wheelData: WheelData\n//   // resultId: number\n//   winningSegment: string\n//   width: number\n//   height: number\n//   // call API start spinning\n//   isSpin: boolean\n//   onFinished: (value: any) => void\n//   primaryColor?: string\n//   contrastColor?: string\n//   size?: number\n//   upDuration?: number\n//   downDuration?: number\n//   fontFamily?: string\n// }\n\n// const WheelComponent = ({\n//   wheelData,\n//   winningSegment,\n//   onFinished,\n//   primaryColor = 'black',\n//   contrastColor = 'white',\n//   size = 180,\n//   upDuration = 100,\n//   downDuration = 1000,\n//   fontFamily = 'proxima-nova',\n//   width,\n//   height,\n//   isSpin\n// }: WheelProps) => {\n//   const segments = wheelData?.items?.map((item) => item?.image)\n//   const segColors = wheelData?.items?.map((item) => item?.color_bg)\n//   let currentSegment = ''\n//   let isStarted = false\n//   const [isFinished, setFinished] = React.useState(false)\n//   let timerHandle = 0\n//   const timerDelay = segments.length\n//   let angleCurrent = 0\n//   let angleDelta = 0\n//   let canvasContext: CanvasRenderingContext2D\n//   let maxSpeed = (Math.PI / segments?.length) as number\n//   const upTime = segments.length * upDuration\n//   const downTime = segments.length * downDuration\n//   let spinStart = 0\n//   let frames = 0\n//   const centerX = width / 2\n//   const centerY = height / 2\n//   React.useEffect(() => {\n//     wheelInit()\n//     setTimeout(() => {\n//       window.scrollTo(0, 1)\n//     }, 0)\n//   }, [])\n//   const wheelInit = () => {\n//     initCanvas()\n//     wheelDraw()\n//   }\n\n//   const initCanvas = () => {\n//     let canvas = document.getElementById('canvas') as HTMLCanvasElement\n//     if (navigator.userAgent.indexOf('MSIE') !== -1) {\n//       canvas = document.createElement('canvas') as HTMLCanvasElement\n//       canvas.setAttribute('width', `${width}`)\n//       canvas.setAttribute('height', `${height}`)\n//       canvas.setAttribute('id', 'canvas')\n//       var wheelElement = document.getElementById('wheel') as HTMLDivElement\n//       wheelElement.appendChild(canvas)\n//     }\n//     canvas.addEventListener('click', isSpin ? spin : () => {}, false)\n//     canvasContext = canvas.getContext('2d') as CanvasRenderingContext2D\n//   }\n//   const spin = () => {\n//     isStarted = true\n//     console.log('spin')\n\n//     if (timerHandle === 0) {\n//       spinStart = new Date().getTime()\n//       maxSpeed = Math.PI / segments.length\n//       frames = 0\n//       timerHandle = (setInterval(onTimerTick, timerDelay) as unknown) as number\n//     }\n//   }\n//   const onTimerTick = () => {\n//     frames++\n//     draw()\n//     const duration = new Date().getTime() - spinStart\n//     let progress = 0\n//     let finished = false\n//     if (duration < upTime) {\n//       progress = duration / upTime\n//       angleDelta = maxSpeed * Math.sin((progress * Math.PI) / 2)\n//     } else {\n//       if (winningSegment) {\n//         if (currentSegment === winningSegment && frames > segments.length) {\n//           progress = duration / upTime\n//           angleDelta =\n//             maxSpeed * Math.sin((progress * Math.PI) / 2 + Math.PI / 2)\n//           progress = 1\n//         } else {\n//           progress = duration / downTime\n//           angleDelta =\n//             maxSpeed * Math.sin((progress * Math.PI) / 2 + Math.PI / 2)\n//         }\n//       } else {\n//         progress = duration / downTime\n//         angleDelta = maxSpeed * Math.sin((progress * Math.PI) / 2 + Math.PI / 2)\n//       }\n//       if (progress >= 1) finished = true\n//     }\n\n//     angleCurrent += angleDelta\n//     while (angleCurrent >= Math.PI * 2) angleCurrent -= Math.PI * 2\n//     if (finished) {\n//       setFinished(true)\n//       onFinished(currentSegment)\n//       clearInterval(timerHandle)\n//       timerHandle = 0\n//       angleDelta = 0\n//     }\n//   }\n\n//   const wheelDraw = () => {\n//     clear()\n//     drawWheel()\n//     drawNeedle()\n//   }\n\n//   const draw = () => {\n//     clear()\n//     drawWheel()\n//     drawNeedle()\n//   }\n\n//   const drawSegment = (key: number, lastAngle: number, angle: number) => {\n//     const ctx = canvasContext as CanvasRenderingContext2D\n//     const value = segments[key]\n//     ctx.save()\n//     ctx.beginPath()\n//     ctx.moveTo(centerX, centerY)\n//     ctx.arc(centerX, centerY, size, lastAngle, angle, false)\n//     ctx.lineTo(centerX, centerY)\n//     ctx.closePath()\n//     ctx.fillStyle = segColors[key]\n//     ctx.fill()\n//     ctx.stroke()\n//     ctx.save()\n//     ctx.translate(centerX, centerY)\n//     ctx.rotate((lastAngle + angle) / 2)\n//     ctx.fillStyle = contrastColor\n//     ctx.font = 'bold 1em ' + wheelData?.turn_button?.font_family || fontFamily\n//     const image = new Image()\n//     image.src = value\n//     image.addEventListener('load', () => {\n//       ctx.drawImage(image, 0, 0, size / 2 + 20, 0)\n//     })\n//     // ctx.fillText(value.substr(0, 21), size / 2 + 20, 0)\n//     ctx.restore()\n//   }\n\n//   const drawWheel = () => {\n//     const ctx = canvasContext\n//     let lastAngle = angleCurrent\n//     const len = segments.length\n//     const PI2 = Math.PI * 2\n//     ctx.lineWidth = 1\n//     ctx.strokeStyle = primaryColor\n//     ctx.textBaseline = 'middle'\n//     ctx.textAlign = 'center'\n//     ctx.font = '1em ' + wheelData?.turn_button?.font_family || fontFamily\n//     for (let i = 1; i <= len; i++) {\n//       const angle = PI2 * (i / len) + angleCurrent\n//       drawSegment(i - 1, lastAngle, angle)\n//       lastAngle = angle\n//     }\n\n//     // Draw a center circle\n//     ctx.beginPath()\n//     ctx.arc(centerX, centerY, 40, 0, PI2, false)\n//     ctx.closePath()\n//     ctx.fillStyle = primaryColor\n//     ctx.lineWidth = 10\n//     ctx.strokeStyle = contrastColor\n//     ctx.fill()\n//     ctx.font = 'bold 1em ' + wheelData?.turn_button?.font_family || fontFamily\n//     ctx.fillStyle = contrastColor\n//     ctx.textAlign = 'center'\n//     ctx.fillText(wheelData?.turn_button?.text, centerX, centerY + 3)\n//     ctx.stroke()\n\n//     // Draw outer circle\n//     ctx.beginPath()\n//     ctx.arc(centerX, centerY, size, 0, PI2, false)\n//     ctx.closePath()\n\n//     ctx.lineWidth = 10\n//     ctx.strokeStyle = primaryColor\n//     ctx.stroke()\n//   }\n\n//   const drawNeedle = () => {\n//     const ctx = canvasContext as CanvasRenderingContext2D\n//     ctx.lineWidth = 1\n//     ctx.strokeStyle = contrastColor\n//     ctx.fillStyle = contrastColor\n//     ctx.beginPath()\n//     ctx.moveTo(centerX + 20, centerY - 50)\n//     ctx.lineTo(centerX - 20, centerY - 50)\n//     ctx.lineTo(centerX, centerY - 70)\n//     ctx.closePath()\n//     ctx.fill()\n//     const change = angleCurrent + Math.PI / 2\n//     let i =\n//       segments.length -\n//       Math.floor((change / (Math.PI * 2)) * segments.length) -\n//       1\n//     if (i < 0) i = i + segments.length\n//     ctx.textAlign = 'center'\n//     ctx.textBaseline = 'middle'\n//     ctx.fillStyle = primaryColor\n//     ctx.font = 'bold 1.5em ' + wheelData?.turn_button?.font_family || fontFamily\n//     currentSegment = segments[i]\n//     isStarted && ctx.fillText(currentSegment, centerX + 10, centerY + size + 50)\n//   }\n//   const clear = () => {\n//     const ctx = canvasContext\n//     ctx.clearRect(0, 0, width, height)\n//   }\n//   return (\n//     <div id='wheel'>\n//       <canvas\n//         id='canvas'\n//         width={width}\n//         height={height}\n//         style={{\n//           pointerEvents: isFinished ? 'none' : 'auto'\n//         }}\n//         onClick={spin}\n//       />\n//     </div>\n//   )\n// }\n// export default WheelComponent\n"],"names":["Array","prototype","includes","Object","defineProperty","value","valueToFind","fromIndex","TypeError","o","len","length","n","k","Math","max","abs","sameValueZero","x","y","isNaN","String","search","start","indexOf","find","predicate","thisArg","arguments","kValue","call","isExpectType","param","types","some","type","toString","slice","toLowerCase","has","data","key","hasOwnProperty","removeEnter","str","filter","s","join","getNumber","num","NaN","Number","hasBackground","color","toLocaleLowerCase","trim","test","alpha","exec","throttle","fn","wait","timeId","args","setTimeout","apply","clearTimeout","computeRange","rangeArr","ascendingArr","sum","map","reduce","prev","curr","res","push","random","findIndex","splitText","ctx","text","getWidth","lineClamp","Infinity","lines","EndWidth","measureText","width","i","currWidth","maxWidth","Dep","subs","addSub","sub","notify","forEach","update","hasProto","def","obj","val","enumerable","writable","configurable","parsePath","path","segments","segment","traverse","dfs","keys","oldArrayProto","newArrayProto","create","methods","method","luckyOb","walk","dep","Observer","isArray","getOwnPropertyNames","defineReactive","observe","property","getOwnPropertyDescriptor","getter","get","setter","set","childOb","target","newVal","uid","Watcher","$lucky","expr","cb","options","id","deep","oldVal","Lucky","config","el","nodeType","divElement","flag","document","querySelector","canvasElement","createElement","appendChild","getContext","setAttribute","addEventListener","e","handleClick","initWindowFunction","console","error","window","resize","MutationObserver","documentElement","attributes","beforeResize","setHTMLFontSize","setDpr","resetWidthAndHeight","zoomCanvas","initLucky","boxWidth","boxHeight","_e","htmlFontSize","getComputedStyle","fontSize","clearCanvas","height","clearRect","dpr","devicePixelRatio","offsetWidth","offsetHeight","getLength","style","overflow","transform","scale","rAF","requestAnimationFrame","callback","setInterval","clearInterval","timeout","isWeb","loadImg","src","info","resolveName","Promise","resolve","reject","imgObj","Image","onload","onerror","drawImage","rectInfo","drawImg","miniProgramOffCtx","temp","getImageData","putImageData","index","err","computedWidthAndHeight","imgInfo","maxHeight","trueWidth","trueHeight","changeUnits","denominator","replace","_val","unit","handleCssUnit","px","rem","vw","innerWidth","otherHandleCssUnit","maxLength","getOffsetX","getOffscreenCanvas","_offscreenCanvas","_ctx","$set","$computed","$watch","handler","watchOpt","watcher","immediate","unWatchFn","getAngle","deg","PI","getArcPointerByDeg","r","cos","toFixed","sin","fanShapedByArc","_minRadius","maxRadius","end","gutter","beginPath","maxGutter","maxStart","maxEnd","arc","lineTo","closePath","quad","easeIn","t","b","c","d","easeOut","LuckyWheel","Map","initData","initWatch","initComputed","beforeCreate","init","Radius","min","translate","draw","afterResize","prizeRadius","prizeDeg","prizeAng","rotateDeg","maxBtnRadius","startTime","endTime","stopDeg","endDeg","FPS","prizeFlag","step","blocks","prizes","buttons","defaultConfig","defaultStyle","offsetDegree","speed","speedFunction","accelerationTime","decelerationTime","stopRange","fontColor","fontStyle","fontWeight","background","wordWrap","lengthLimit","_newData","initImageCache","beforeInit","afterInit","willUpdateImgs","block","imgs","prize","btn","imgName","willUpdate","allPromise","cellIndex","_imgInfo","imgIndex","loadAndCacheImg","all","then","isPointInPath","offsetX","offsetY","startCallback","cellName","cell","currImg","ImageCache","formatter","drawBlock","radius","_blockIndex","fillStyle","fill","_imgIndex","blockImg","xAxis","left","yAxis","top","save","rotate","restore","_defaultConfig","_defaultStyle","beforeDraw","blockIndex","padding","split","shortSide","getFontX","font","line","getFontY","lineIndex","lineHeight","prizeIndex","currMiddleDeg","prizeHeight","prizeImg","fonts","adjacentSide","tan","fillText","_btnIndex","pointer","moveTo","btnImg","afterDraw","carveOnGunwaleOfAMovingBoat","Date","now","prevSpeed","prevDeg","currSpeed","play","afterStart","run","stop","item","range","endCallback","_prize","startInterval","endInterval","bind","conversionAxis","LuckyWheelComponent","props","myLucky","React","createRef","lucky","undefined","componentDidMount","current","onSuccess","onError","onFinally","componentDidUpdate","prevProps","onStart","onEnd","render","ref","Component","defaultProps"],"mappings":"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"}